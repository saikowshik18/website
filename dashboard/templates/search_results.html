{% extends 'base.html' %}

{% block content %}
<h2>Search Products</h2>

<div id="productContainer" class="product-grid">
    <!-- AJAX results will appear here -->
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    $('#searchInput').on('keyup', function() {
        let query = $(this).val().trim();  // Remove whitespace

        if (query.length === 0) {
            $('#productContainer').html('<p>Start typing to search products...</p>');
            return;  // Do not send AJAX if input is empty
        }

        $.ajax({
            url: "{% url 'search_products_ajax' %}",
            data: {'q': query},
            dataType: 'json',
            success: function(data) {
                let html = '';
                if (data.products.length > 0) {
                    data.products.forEach(function(product) {
                        html += `
                        <div class="product-card">
                            <img src="${product.image_url}" alt="${product.name}" class="product-img">
                            <h3>${product.name}</h3>
                            <p>Price: ${product.price}</p>
                            <p>Category: ${product.category}</p>
                            <p>Location: ${product.location}, ${product.floor}</p>
                        </div>`;
                    });
                } else {
                    html = '<p>No products found.</p>';
                }
                $('#productContainer').html(html);
            }
        });
    });
});

</script>
{% endblock %}
